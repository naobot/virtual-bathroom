{"ast":null,"code":"var _jsxFileName = \"/Users/nao/code/bathroom/client/src/App.js\";\nimport React, { Component } from 'react';\nimport Pusher from 'pusher-js';\nimport WaitingRoom from './WaitingRoom';\nimport Stall from './Stall';\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n    this.pusher = new Pusher('93d5b6db6095187f5ef6', {\n      cluster: 'us2',\n      encrypted: true\n    });\n    this.state = {\n      currentView: null,\n      stalls: [] // array of Stall components\n\n    };\n    this.max_occupancy = 1; // ADJUST AS NEEDED\n\n    this.num_stalls = 1; // ADJUST AS NEEDED\n\n    this.handleEnterStall = this.handleEnterStall.bind(this);\n    this.updateOccupants = this.updateOccupants.bind(this);\n  }\n\n  handleEnterStall(e) {\n    var stallEntered = false;\n\n    for (var i = 0; !stallEntered && i < this.state.stalls.length; i++) {\n      var currentStall = { ...this.state.stalls[i]\n      };\n\n      if (currentStall.occupants < this.max_occupancy) {\n        // this.updateOccupants(i, currentStall.occupants+1);\n        this.setState(currentState => {\n          return {\n            currentView: /*#__PURE__*/React.createElement(Stall, {\n              id: i,\n              pusher: this.pusher,\n              max: this.max_occupancy,\n              onOccupancyChange: this.updateOccupants,\n              __self: this,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 32,\n                columnNumber: 26\n              }\n            })\n          };\n        });\n        stallEntered = true;\n      } else {\n        console.log(`Stall ${i} full`);\n      }\n    }\n\n    if (!stallEntered) {\n      alert('no vacant stalls available!');\n    }\n  }\n\n  updateOccupants(stallId, numOccupants) {\n    var stallsCopy = Array.from(this.state.stalls);\n    stallsCopy[stallId].occupants = numOccupants;\n    console.log(stallsCopy);\n    this.setState(currentState => {\n      return {\n        stalls: stallsCopy\n      };\n    });\n  }\n\n  componentDidMount() {\n    // create stalls\n    var stallList = [];\n\n    for (var i = 0; i < this.num_stalls; i++) {\n      let stall = {\n        id: i,\n        occupants: 0\n      };\n      stallList.push(stall);\n    }\n\n    this.setState(currentState => {\n      return {\n        stalls: stallList,\n        currentView: /*#__PURE__*/React.createElement(WaitingRoom, {\n          onEnterStall: this.handleEnterStall,\n          pusher: this.pusher,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 69,\n            columnNumber: 22\n          }\n        })\n      };\n    });\n  } // updateVisitors(members) {\n  //   this.setState({\n  //     visitors: members,\n  //   },\n  //   // console.log('number of visitors updated')\n  //   )\n  // }\n\n\n  render() {\n    const stalls = this.state.stalls.map(stall => /*#__PURE__*/React.createElement(\"li\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 7\n      }\n    }, \"Stall \", stall.id, \": \", stall.occupants, \"/\", this.max_occupancy));\n    return /*#__PURE__*/React.createElement(\"div\", {\n      id: \"app\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 7\n      }\n    }, \"Number of Stalls: \", this.num_stalls, /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 44\n      }\n    }), stalls, /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 17\n      }\n    }), this.state.currentView);\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["/Users/nao/code/bathroom/client/src/App.js"],"names":["React","Component","Pusher","WaitingRoom","Stall","App","constructor","props","pusher","cluster","encrypted","state","currentView","stalls","max_occupancy","num_stalls","handleEnterStall","bind","updateOccupants","e","stallEntered","i","length","currentStall","occupants","setState","currentState","console","log","alert","stallId","numOccupants","stallsCopy","Array","from","componentDidMount","stallList","stall","id","push","render","map"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport Pusher from 'pusher-js';\nimport WaitingRoom from './WaitingRoom';\nimport Stall from './Stall';\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n    this.pusher = new Pusher('93d5b6db6095187f5ef6', {\n      cluster: 'us2',\n      encrypted: true,\n    });\n    this.state = {\n      currentView: null,\n      stalls: [], // array of Stall components\n    };\n    this.max_occupancy = 1; // ADJUST AS NEEDED\n    this.num_stalls = 1; // ADJUST AS NEEDED\n    this.handleEnterStall = this.handleEnterStall.bind(this);\n    this.updateOccupants = this.updateOccupants.bind(this);\n  }\n\n  handleEnterStall(e) {\n    var stallEntered = false;\n\n    for (var i = 0; !stallEntered && i < this.state.stalls.length; i++) {\n      var currentStall = {...this.state.stalls[i]};\n      if (currentStall.occupants < this.max_occupancy) {\n        // this.updateOccupants(i, currentStall.occupants+1);\n        this.setState(currentState => {\n          return {\n            currentView: <Stall id={i} pusher={this.pusher} max={this.max_occupancy} onOccupancyChange={this.updateOccupants} />,\n          };\n        });\n        stallEntered = true;\n      }\n      else {\n        console.log(`Stall ${i} full`);\n      }\n    }\n\n    if (!stallEntered) {\n      alert('no vacant stalls available!');\n    }\n\n  }\n\n  updateOccupants(stallId, numOccupants) {\n    var stallsCopy = Array.from(this.state.stalls);\n    stallsCopy[stallId].occupants = numOccupants;\n    console.log(stallsCopy);\n    this.setState(currentState => {\n      return {\n        stalls: stallsCopy,\n      }\n    });\n  }\n\n  componentDidMount() {\n    // create stalls\n    var stallList = [];\n    for (var i = 0; i < this.num_stalls; i++) {\n      let stall = { id: i, occupants: 0 };\n      stallList.push(stall);\n    }\n    this.setState(currentState => {\n      return {\n        stalls: stallList,\n        currentView: <WaitingRoom onEnterStall={this.handleEnterStall} pusher={this.pusher} />\n      };\n    });\n  }\n\n  // updateVisitors(members) {\n  //   this.setState({\n  //     visitors: members,\n  //   },\n  //   // console.log('number of visitors updated')\n  //   )\n  // }\n\n  render() {\n    const stalls = this.state.stalls.map((stall) =>\n      <li>Stall {stall.id}: {stall.occupants}/{this.max_occupancy}</li>\n    );\n    return (\n      <div id=\"app\">\n        Number of Stalls: {this.num_stalls}<br/>\n        {stalls}<br/>\n        {this.state.currentView}\n      </div>\n    );\n  }\n\n}\n\nexport default App;"]},"metadata":{},"sourceType":"module"}